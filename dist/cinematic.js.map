{"version":3,"file":"cinematic.js","sourceRoot":"","sources":["../lib/cinematic.ts"],"names":[],"mappings":"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","sourcesContent":["interface Document {\n    webkitExitFullscreen: any;\n    webkitFullscreenElement: any;\n    webkitFullscreenEnabled: any;\n    pictureInPictureElement: any;\n    exitPictureInPicture: () => Promise<void>;\n}\n\ninterface HTMLVideoElement {\n    webkitEnterFullscreen: any;\n    webkitSupportsFullscreen: any;\n    requestPictureInPicture: () => Promise<PictureInPictureWindow>;\n}\n\ninterface Options {\n    selector: string;\n    baseUri: string;\n    autoplay: boolean;\n    startTime: number;\n    deeplink: string;\n    deeplinkCallback?: Function\n    rememberVolume: boolean;\n    rememberQuality: boolean;\n    quality: string;\n    sources: VideoQuality[];\n    video: CinematicVideo | null;\n    playlist: CinematicPlaylist | null;\n    closeCallback?: CloseCallback;\n    translations: Translations;\n}\n\ninterface VideoOptions {\n    poster: string;\n    titleIcon: string;\n    title: string;\n    description: string;\n    subtitles: string;\n    sources: VideoQuality[];\n}\n\ninterface CloseCallback {\n    (): void;\n}\n\ninterface VideoQuality {\n    quality: string;\n    sources: VideoSource[];\n}\n\ninterface VideoSource {\n    type: string;\n    source: string;\n}\n\ninterface Translations {\n    pause: string;\n    play: string;\n    restart: string;\n    mute: string;\n    unmute: string;\n    settings: string;\n    quality: string;\n    playbackSpeed: string;\n    fullscreen: string;\n    deeplink: string;\n    close: string;\n    deeplinkCopied: string;\n    exitFullscreen: string;\n    showSubtitles: string;\n    hideSubtitles: string;\n    pictureInPicture: string;\n    chromecast: string;\n    showVideoInfo: string;\n    hideVideoInfo: string;\n}\n\nclass Cinematic {\n\n    options: Options;\n\n    defaults: Options = {\n        selector: '',\n        baseUri: '../dist',\n        autoplay: false,\n        startTime: 0,\n        deeplink: '',\n        rememberVolume: false,\n        rememberQuality: false,\n        quality: '720p',\n        sources: [],\n        video: null,\n        playlist: null,\n        translations: {\n            pause: 'Pause',\n            play: 'Play',\n            restart: 'Restart',\n            mute: 'Mute',\n            unmute: 'Unmute',\n            settings: 'Settings',\n            quality: 'Quality',\n            playbackSpeed: 'Speed',\n            fullscreen: 'Fullscreen',\n            close: 'Close',\n            deeplink: 'Copy deeplink to clipboard',\n            deeplinkCopied: 'Link was copied',\n            exitFullscreen: 'Exit Fullscreen',\n            showSubtitles: 'Show Subtitles',\n            hideSubtitles: 'Hide Subtitles',\n            pictureInPicture: 'Picture in picture',\n            chromecast: 'Stream',\n            showVideoInfo: 'Show video information',\n            hideVideoInfo: 'Hide video information'\n        }\n    };\n\n    _container: any;\n    _video: HTMLVideoElement;\n    _sources: HTMLSourceElement[] = [];\n    _cues: HTMLElement;\n    _cuesContainer: HTMLElement;\n    _uiWrapper: HTMLDivElement;\n    _videoTitleIcon: HTMLImageElement;\n    _videoTitle: HTMLDivElement;\n    _videoInfoButton: HTMLDivElement;\n    _videoDescription: HTMLDivElement;\n    _controls: HTMLElement;\n    _playButton: HTMLDivElement;\n    _bufferBar: HTMLProgressElement;\n    _progressBar: HTMLProgressElement;\n    _timer: HTMLElement;\n    _volumeSlider: HTMLInputElement;\n    _volumeButton: HTMLDivElement;\n    _settingsWrapper: HTMLDivElement;\n    _qualitySelect: HTMLSelectElement;\n    _qualitySettingsSection: HTMLDivElement;\n    _qualitySettingsContainer: HTMLDivElement;\n    _speedSettingsContainer: HTMLDivElement;\n    _captionsButton: HTMLDivElement;\n    _deeplinkButton: HTMLDivElement;\n    _pipButton: HTMLDivElement;\n    _chromecastButton: HTMLDivElement;\n    _fullScreenButton: HTMLDivElement;\n    _closeButton: HTMLDivElement;\n    _overlayWrapper: HTMLDivElement;\n    _overlayIcon: HTMLDivElement;\n    _overlayText: HTMLDivElement;\n\n    totalSeconds = 0;\n    playedSeconds = 0;\n    volume = 0;\n    quality = '';\n    speed = 1;\n    tracks: TextTrack | null;\n    cues: TextTrackCueList | null;\n    playlist: CinematicPlaylist;\n\n    captionsEnabled = false;\n    fullScreenEnabled = false;\n    pipEnabled = false;\n    userActive = false;\n    userActiveCheck: number;\n    userInactiveTimeout: number;\n    overlayHideTimeout: number;\n    doubleClickTimeout: number;\n\n    constructor(options: Options) {\n        this.options = {...this.defaults, ...options};\n\n        const _passedContainer = document.querySelector(this.options.selector);\n        if (!_passedContainer) {\n            throw new Error('CinematicJS: Passed selector does not point to a DOM element.');\n        }\n        this._container = _passedContainer;\n\n        if (this.options.playlist) {\n            this.playlist = this.options.playlist;\n        } else if (this.options.video) {\n            this.playlist = new CinematicPlaylist(false, [this.options.video]);\n        } else {\n            throw new Error('CinematicJS: Either a single `video` or a `playlist` has to be passed as options.');\n        }\n\n        this.quality = this.options.quality;\n        if (this.options.rememberQuality) {\n            const storedQuality = this.readFromLocalStore('quality');\n            if (storedQuality) {\n                this.quality = this.handleVideoQualityFallback(storedQuality);\n            }\n        }\n\n        if ('pictureInPictureEnabled' in document) {\n            this.pipEnabled = true;\n        }\n\n        this.loadIcons();\n        this.renderPlayer();\n        this.updateDisplayedVideoInfo();\n        this.setupEvents();\n\n        this._video.load();\n\n        if (this.options.rememberVolume) {\n            const storedVolume = this.readFromLocalStore('volume');\n            if (storedVolume) {\n                this._video.volume = parseFloat(storedVolume);\n            }\n            const storedMuteState = this.readFromLocalStore('muted');\n            if (storedMuteState) {\n                this._video.muted = storedMuteState === 'true';\n            }\n        }\n\n        this._container.cinematic = this as Cinematic;\n    }\n\n    loadIcons() {\n        const _iconContainer = document.createElement('span');\n        _iconContainer.classList.add('cinematicjs-icon-container');\n        document.body.appendChild(_iconContainer);\n\n        const request = new XMLHttpRequest();\n        request.open(\"GET\", this.options.baseUri + '/icons.svg', true);\n        request.responseType = \"document\";\n        request.onload = () => {\n            const svg = request?.responseXML?.documentElement;\n            // Don't render anything that is not an SVG, e.g. an HTML error page\n            if (svg && svg.nodeName === 'svg') {\n                _iconContainer.appendChild(svg);\n            }\n        }\n        request.send();\n    }\n\n    renderPlayer() {\n        this._container.classList.add('cinematicjs-video-container');\n\n        let initialVideo = this.playlist.getCurrentVideo();\n\n        this._video = document.createElement('video');\n        this._video.preload = 'metadata';\n        this._video.tabIndex = -1;\n        this._video.playsInline = true;\n        // Suppress the unwanted right click context menu of the video element itself\n        this._video.oncontextmenu = () => false;\n        if (this.options.autoplay) {\n            this._video.autoplay = true;\n        }\n        this._container.appendChild(this._video);\n\n        this.fullScreenEnabled = document.fullscreenEnabled || document.webkitFullscreenEnabled || this._video.webkitSupportsFullscreen;\n\n        let startSource = initialVideo.getSourcesForQuality(this.quality);\n\n        if (!startSource) {\n            throw new Error('CinematicJS: Passed quality does not match any of the passed sources.');\n        }\n\n        startSource.sources.forEach(source => {\n            const _source = document.createElement('source');\n            _source.src = source.source;\n            _source.type = source.type;\n            this._video.appendChild(_source);\n            this._sources.push(_source);\n        });\n\n        this._overlayWrapper = document.createElement('div');\n        this._overlayWrapper.classList.add('cinematicjs-video-overlay-wrapper');\n        this._overlayWrapper.classList.add('cinematicjs-hidden');\n        this._container.appendChild(this._overlayWrapper);\n\n        const _overlayContainer = document.createElement('div');\n        _overlayContainer.classList.add('cinematicjs-video-overlay-container');\n        this._overlayWrapper.appendChild(_overlayContainer);\n\n        this._overlayIcon = document.createElement('div');\n        this._overlayIcon.classList.add('cinematicjs-video-overlay-icon');\n        Cinematic.renderButtonIcon(this._overlayIcon, 'mute');\n        _overlayContainer.appendChild(this._overlayIcon);\n\n        this._overlayText = document.createElement('div');\n        this._overlayText.classList.add('cinematicjs-video-overlay-text');\n        _overlayContainer.appendChild(this._overlayText);\n\n        this._uiWrapper = document.createElement('div');\n        this._uiWrapper.classList.add('cinematicjs-ui-wrapper');\n        this._container.appendChild(this._uiWrapper);\n\n        const _header = document.createElement('div');\n        _header.classList.add('cinematicjs-video-header');\n        this._uiWrapper.appendChild(_header);\n\n        this._videoTitleIcon = document.createElement('img');\n        this._videoTitleIcon.classList.add('cinematicjs-video-icon');\n        _header.appendChild(this._videoTitleIcon);\n\n        this._videoTitle = document.createElement('div');\n        this._videoTitle.classList.add('cinematicjs-video-title');\n        this._videoTitle.addEventListener('click', () => this.handleVideoInfoToggle());\n        _header.appendChild(this._videoTitle);\n\n        this._videoInfoButton = document.createElement('div');\n        this._videoInfoButton.classList.add('cinematicjs-video-info-button');\n        this._videoInfoButton.addEventListener('click', () => this.handleVideoInfoToggle());\n        this._videoInfoButton.title = this.options.translations.showVideoInfo;\n        Cinematic.renderButtonIcon(this._videoInfoButton, 'info');\n        _header.appendChild(this._videoInfoButton);\n\n        const _headerSpacer = document.createElement('div');\n        _headerSpacer.classList.add('cinematicjs-video-header-spacer');\n        _header.appendChild(_headerSpacer);\n\n        this._chromecastButton = document.createElement('div');\n        this._chromecastButton.classList.add('cinematicjs-video-control-button');\n        this._chromecastButton.classList.add('cinematicjs-hidden');\n        this._chromecastButton.title = this.options.translations.chromecast;\n        this._chromecastButton.addEventListener('click', () => this._video.remote.prompt());\n        Cinematic.renderButtonIcon(this._chromecastButton, 'chromecast');\n        _header.appendChild(this._chromecastButton);\n\n        if (this._video.remote) {\n            this._video.remote.watchAvailability((available) => {\n                this._chromecastButton.classList.toggle('cinematicjs-hidden', !available);\n            }).catch(() => {\n                this._chromecastButton.classList.add('cinematicjs-hidden');\n            });\n        }\n\n        if (this.options.closeCallback) {\n            this._closeButton = document.createElement('div');\n            this._closeButton.classList.add('cinematicjs-video-close-button');\n            this._closeButton.title = this.options.translations.close;\n            Cinematic.renderButtonIcon(this._closeButton, 'close');\n            _header.appendChild(this._closeButton);\n        }\n\n        this._videoDescription = document.createElement('div');\n        this._videoDescription.classList.add('cinematicjs-video-description');\n        this._videoDescription.classList.add('cinematicjs-hidden');\n        this._uiWrapper.appendChild(this._videoDescription);\n\n        const _footer = document.createElement('div');\n        _footer.classList.add('cinematicjs-video-footer');\n        this._uiWrapper.appendChild(_footer);\n\n        const _progressWrapper = document.createElement('div');\n        _progressWrapper.classList.add('cinematicjs-video-progress-wrapper');\n        _footer.appendChild(_progressWrapper);\n\n        this._bufferBar = document.createElement('progress');\n        this._bufferBar.classList.add('cinematicjs-video-buffer-bar');\n        this._bufferBar.value = 0;\n        _progressWrapper.appendChild(this._bufferBar);\n\n        this._progressBar = document.createElement('progress');\n        this._progressBar.classList.add('cinematicjs-video-progress-bar');\n        this._progressBar.value = 0;\n        _progressWrapper.appendChild(this._progressBar);\n\n        this._controls = document.createElement('div');\n        this._controls.classList.add('cinematicjs-video-controls');\n        _footer.appendChild(this._controls);\n\n        this._playButton = document.createElement('div');\n        this._playButton.classList.add('cinematicjs-video-control-button');\n        Cinematic.renderButtonIcon(this._playButton, 'play');\n        this._controls.appendChild(this._playButton);\n\n        this._timer = document.createElement('span');\n        this._timer.classList.add('cinematicjs-video-control-timer');\n        this._timer.textContent = '00:00:00 / 00:00:00';\n        this._controls.appendChild(this._timer);\n\n        const _spacer = document.createElement('div');\n        _spacer.classList.add('video-control-spacer');\n        this._controls.appendChild(_spacer);\n\n        const _volumeWrapper = document.createElement('div');\n        _volumeWrapper.classList.add('cinematicjs-video-volume-wrapper');\n        this._controls.appendChild(_volumeWrapper);\n\n        this._volumeSlider = document.createElement('input');\n        this._volumeSlider.type = 'range';\n        this._volumeSlider.min = '0';\n        this._volumeSlider.max = '1';\n        this._volumeSlider.step = '0.05';\n        this._volumeSlider.value = '1';\n        this._volumeSlider.classList.add('cinematicjs-video-volume-slider');\n        _volumeWrapper.appendChild(this._volumeSlider);\n\n        this._volumeButton = document.createElement('div');\n        this._volumeButton.classList.add('cinematicjs-video-control-button');\n        this._volumeButton.title = this.options.translations.mute;\n        Cinematic.renderButtonIcon(this._volumeButton, 'sound');\n        _volumeWrapper.appendChild(this._volumeButton);\n\n        this._settingsWrapper = document.createElement('div');\n        this._settingsWrapper.classList.add('cinematicjs-video-control-dropdown');\n        this._controls.appendChild(this._settingsWrapper);\n\n        const _settingsButton = document.createElement('div');\n        _settingsButton.classList.add('cinematicjs-video-control-button');\n        _settingsButton.title = this.options.translations.settings;\n        _settingsButton.addEventListener('click', (event) => {\n            this._settingsWrapper.classList.toggle('cinematicjs-dropdown-active');\n            event.stopPropagation();\n        });\n        Cinematic.renderButtonIcon(_settingsButton, 'settings');\n        this._settingsWrapper.appendChild(_settingsButton);\n\n        window.addEventListener('click', (event) => {\n            // Clicks inside the Dropdown should not close it again.\n            if (!(event.target instanceof Element) || !(event.target as Element).matches('.cinematicjs-video-control-dropdown, .cinematicjs-video-control-dropdown *')) {\n                this._settingsWrapper.classList.remove('cinematicjs-dropdown-active');\n            }\n        });\n\n        const _dropDownContent = document.createElement('div');\n        _dropDownContent.classList.add('cinematicjs-video-dropdown-content');\n        this._settingsWrapper.appendChild(_dropDownContent);\n\n        this._qualitySettingsSection = document.createElement('div');\n        this._qualitySettingsSection.classList.add('cinematicjs-video-dropdown-section');\n        _dropDownContent.appendChild(this._qualitySettingsSection);\n\n        const _qualitySettingsTitle = document.createElement('span');\n        _qualitySettingsTitle.textContent = this.options.translations.quality;\n        this._qualitySettingsSection.appendChild(_qualitySettingsTitle);\n\n        this._qualitySelect = document.createElement('select');\n        this._qualitySelect.name = 'quality';\n        this._qualitySelect.addEventListener('change', () => this.handleQualityChange(this._qualitySelect.value));\n\n        this.renderQualityOptions();\n\n        this._qualitySelect.value = this.quality;\n        this._qualitySettingsSection.appendChild(this._qualitySelect);\n\n        const _speedSettingsSection = document.createElement('div');\n        _speedSettingsSection.classList.add('cinematicjs-video-dropdown-section');\n        _dropDownContent.appendChild(_speedSettingsSection);\n\n        const _speedSettingsTitle = document.createElement('span');\n        _speedSettingsTitle.textContent = this.options.translations.playbackSpeed;\n        _speedSettingsSection.appendChild(_speedSettingsTitle);\n\n        const _speedSelect = document.createElement('select');\n        _speedSelect.name = 'speed';\n        _speedSelect.addEventListener('change', () => this.handleSpeedChange(_speedSelect.value));\n\n        [0.5, 1.0, 1.25, 1.5, 1.75, 2.0].forEach(speedSetting => {\n            const _option = document.createElement('option');\n            _option.textContent = speedSetting + 'x';\n            _option.value = speedSetting + '';\n            _speedSelect.appendChild(_option);\n        });\n\n        _speedSelect.value = '1';\n        _speedSettingsSection.appendChild(_speedSelect);\n\n        if (this.options.deeplink) {\n            this._deeplinkButton = document.createElement('div');\n            this._deeplinkButton.classList.add('cinematicjs-video-control-button');\n            this._deeplinkButton.title = this.options.translations.deeplink;\n            this._deeplinkButton.dataset.copiedText = this.options.translations.deeplinkCopied;\n            Cinematic.renderButtonIcon(this._deeplinkButton, 'deeplink');\n            this._controls.appendChild(this._deeplinkButton);\n        }\n\n        this._cuesContainer = document.createElement('div');\n        this._cuesContainer.classList.add('cinematicjs-video-cues-container');\n        this._cuesContainer.classList.add('cinematicjs-hidden');\n        this._container.appendChild(this._cuesContainer);\n\n        this._cues = document.createElement('div');\n        this._cues.classList.add('video-cues');\n        this._cues.classList.add('cinematicjs-hidden');\n        this._cuesContainer.appendChild(this._cues);\n\n        this._captionsButton = document.createElement('div');\n        this._captionsButton.classList.add('cinematicjs-video-control-button');\n        this._captionsButton.title = this.options.translations.showSubtitles;\n        Cinematic.renderButtonIcon(this._captionsButton, 'expanded-cc');\n        this._controls.appendChild(this._captionsButton);\n\n        this.prepareSubtitles();\n\n        if (this.pipEnabled) {\n            this._pipButton = document.createElement('div');\n            this._pipButton.classList.add('cinematicjs-video-control-button');\n            this._pipButton.title = this.options.translations.pictureInPicture;\n            Cinematic.renderButtonIcon(this._pipButton, 'inpicture');\n            this._controls.appendChild(this._pipButton);\n        }\n\n        if (this.fullScreenEnabled) {\n            this._fullScreenButton = document.createElement('div');\n            this._fullScreenButton.classList.add('cinematicjs-video-control-button');\n            this._fullScreenButton.title = this.options.translations.fullscreen;\n            Cinematic.renderButtonIcon(this._fullScreenButton, 'fullscreen');\n            this._controls.appendChild(this._fullScreenButton);\n        }\n    }\n\n    private renderQualityOptions() {\n        this._qualitySelect.textContent = '';\n\n        if (this.playlist.getCurrentVideo().sources.length > 1) {\n            this.playlist.getCurrentVideo().sources.forEach(source => {\n                const _option = document.createElement('option');\n                _option.textContent = source.quality;\n                _option.value = source.quality;\n                this._qualitySelect.appendChild(_option);\n            });\n\n            this._qualitySettingsSection.classList.remove('cinematicjs-hidden');\n        } else {\n            this._qualitySettingsSection.classList.add('cinematicjs-hidden');\n        }\n    }\n\n    /**\n     * Falls back to the best available quality for the current video when it does not provide the given quality.\n     *\n     * @param newQuality the preferred quality to play\n     * @private\n     */\n    private handleVideoQualityFallback(newQuality: string) {\n        if (!newQuality) {\n            return newQuality;\n        }\n\n        let currentVideo = this.playlist.getCurrentVideo();\n        let newSource = currentVideo.getSourcesForQuality(newQuality);\n        if (!newSource) {\n            newQuality = currentVideo.getBestAvailableQuality();\n        }\n\n        return newQuality;\n    }\n\n    private handleQualityChange(newQuality: string) {\n        if (!newQuality) {\n            return;\n        }\n\n        newQuality = this.handleVideoQualityFallback(newQuality);\n        let newSource = this.playlist.getCurrentVideo().getSourcesForQuality(newQuality);\n        if (!newSource) {\n            return;\n        }\n\n        if (this.options.rememberQuality) {\n            this.writeToLocalStore('quality', newQuality);\n        }\n\n        const currentTime = this._video.currentTime;\n        const wasPlaying = !this._video.paused;\n\n        newSource.sources.forEach((videoFormatSource, index) => {\n            const _source = this._sources[index];\n            if (_source) {\n                _source.src = videoFormatSource.source;\n            }\n        });\n\n        this._video.load();\n        this._video.currentTime = currentTime;\n        if (wasPlaying) {\n            this._video.play();\n        }\n        this.quality = newQuality;\n    }\n\n    private handleSpeedChange(newSpeed: string | number) {\n        if (!newSpeed) {\n            return;\n        }\n        this.speed = typeof newSpeed === 'string' ? parseFloat(newSpeed) : newSpeed;\n        this._video.playbackRate = this.speed;\n    }\n\n    private handleVideoInfoToggle() {\n        this._videoDescription.classList.toggle('cinematicjs-hidden');\n        if (this._videoDescription.classList.contains('cinematicjs-hidden')) {\n            this._videoInfoButton.title = this.options.translations.showVideoInfo;\n        } else {\n            this._videoInfoButton.title = this.options.translations.hideVideoInfo;\n        }\n    }\n\n    private prepareSubtitles() {\n        let _oldTrack = this._video.querySelector('track');\n        if (_oldTrack) {\n            this._video.removeChild(_oldTrack);\n            this._captionsButton.classList.add('cinematicjs-hidden');\n        }\n\n        let video = this.playlist.getCurrentVideo();\n        if (!video.subtitles) {\n            this._cues.classList.add('cinematicjs-hidden');\n            this._captionsButton.classList.add('cinematicjs-hidden');\n            this.tracks = null;\n            this.cues = null;\n            return;\n        }\n\n        const _subtitles = document.createElement('track');\n        _subtitles.label = 'subtitles';\n        _subtitles.kind = 'subtitles';\n        _subtitles.src = video.subtitles;\n        _subtitles.default = true;\n        this._video.appendChild(_subtitles);\n\n        const me = this;\n        if (_subtitles.readyState === 2) {\n            me.handleLoadedTrack();\n        } else {\n            _subtitles.addEventListener('load', () => me.handleLoadedTrack());\n        }\n\n        this._captionsButton.classList.remove('cinematicjs-hidden');\n    }\n\n    private handleLoadedTrack() {\n        this.tracks = this._video.textTracks[0];\n        this.tracks.mode = 'hidden';\n        this.cues = this.tracks.cues;\n\n        const me = this;\n        const onCueEnter = function (this: any) {\n            me._cues.textContent = this.text;\n            me._cues.classList.remove('cinematicjs-hidden');\n        };\n\n        const onCueExit = function () {\n            me._cues.textContent = '';\n            me._cues.classList.add('cinematicjs-hidden');\n        };\n\n        if (this.cues) {\n            for (let i = 0; i < this.cues.length; i++) {\n                let cue = this.cues[i];\n                cue.onenter = onCueEnter;\n                cue.onexit = onCueExit;\n            }\n        }\n    }\n\n    setupEvents() {\n        const me = this;\n\n        window.addEventListener('resize', () => this.handlePlayerResize());\n        this.handlePlayerResize();\n\n        if (window.ResizeObserver) {\n            new ResizeObserver(() => this.handlePlayerResize()).observe(this._container);\n        }\n\n        this._playButton.addEventListener('click', () => {\n            if (this._video.ended) {\n                this.playlist.resetToBeginning();\n                this.handleVideoChange();\n            } else if (this._video.paused) {\n                this._video.play();\n            } else {\n                this._video.pause();\n            }\n        });\n\n        this._volumeButton.addEventListener('click', () => {\n            this._video.muted = !this._video.muted;\n        });\n\n        this._volumeSlider.addEventListener('change', () => {\n            // To allow the user to change from mute to a specific volume via the slider.\n            this._video.muted = false;\n            this._video.volume = this.volume = parseFloat(this._volumeSlider.value);\n        });\n\n        this._video.addEventListener('loadedmetadata', function () {\n            me.totalSeconds = this.duration;\n            me._progressBar.setAttribute('max', me.totalSeconds.toString());\n            me._bufferBar.setAttribute('max', me.totalSeconds.toString());\n            me.updateTimer();\n\n            if (me.options.startTime > 0) {\n                this.currentTime = me.options.startTime;\n            }\n        });\n\n        this._video.addEventListener('timeupdate', function () {\n            me.playedSeconds = this.currentTime;\n            me._progressBar.value = me.playedSeconds;\n\n            me.updateTimer();\n        });\n\n        this._video.addEventListener('volumechange', () => {\n            if (this.options.rememberVolume) {\n                this.writeToLocalStore('volume', this._video.volume.toString());\n                this.writeToLocalStore('muted', String(this._video.muted));\n            }\n\n            if (this._video.muted) {\n                // Set the volume slider to its min value to indicate the mute.\n                this._volumeSlider.value = '0';\n                Cinematic.switchButtonIcon(this._volumeButton, 'mute');\n                this._volumeButton.title = this.options.translations.unmute;\n            } else {\n                this._volumeSlider.value = this._video.volume.toString();\n                this._volumeButton.title = this.options.translations.mute;\n                if (this.volume > 0.5) {\n                    Cinematic.switchButtonIcon(this._volumeButton, 'sound');\n                } else {\n                    Cinematic.switchButtonIcon(this._volumeButton, 'low');\n                }\n            }\n        });\n\n        this._video.addEventListener('play', () => {\n            Cinematic.switchButtonIcon(me._playButton, 'pause');\n            me._playButton.title = me.options.translations.pause;\n            me._video.focus();\n\n            // Shows the timer even when video container is invisible during initialization of the player\n            this.handlePlayerResize();\n        });\n\n        this._video.addEventListener('pause', function () {\n            Cinematic.switchButtonIcon(me._playButton, 'play');\n            me._playButton.title = me.options.translations.play;\n        });\n\n        this._video.addEventListener('ended', () => {\n            if (this.playlist.shouldPlayNextVideo()) {\n                this.playlist.startNextVideo();\n                this.handleVideoChange();\n            } else {\n                Cinematic.switchButtonIcon(this._playButton, 'repeat');\n                this._playButton.title = me.options.translations.restart;\n                this.showControls();\n            }\n        });\n\n        this._video.addEventListener('progress', function () {\n            if (this.duration > 0) {\n                for (let i = 0; i < this.buffered.length; i++) {\n                    const bufferRangeIndex = this.buffered.length - 1 - i;\n                    const bufferStart = this.buffered.start(bufferRangeIndex);\n                    const bufferEnd = this.buffered.end(bufferRangeIndex);\n                    if (bufferStart <= this.currentTime) {\n                        me._bufferBar.value = (bufferEnd / this.duration) * 100;\n                        break;\n                    }\n                }\n            }\n        });\n\n        this._video.addEventListener('click', () => {\n            window.setTimeout(() => {\n                if (this._video.ended) {\n                    this.playlist.resetToBeginning();\n                    this.handleVideoChange();\n                    this.showOverlay('play', null, true);\n                } else if (me._video.paused) {\n                    me._video.play();\n                    this.showOverlay('play', null, true);\n                } else {\n                    me._video.pause();\n                    this.showOverlay('pause', null, true);\n                }\n                this.userActive = true;\n            }, 300);\n        });\n\n        this._video.addEventListener('dblclick', (event) => {\n            if (this.doubleClickTimeout) {\n                clearTimeout(this.doubleClickTimeout);\n            }\n\n            // Get the bounding rectangle of target\n            const rect = this._video.getBoundingClientRect();\n            const thirds = rect.width / 3;\n\n            // Mouse position\n            const x = event.clientX - rect.left;\n\n            if (x <= thirds) {\n                this._video.currentTime -= 10;\n                this.showOverlay('backwards', '- 10s', true);\n            } else if (x <= thirds * 2) {\n                this.toggleFullScreen();\n            } else {\n                this._video.currentTime += 10;\n                this.showOverlay('fastforward', '+ 10s', true);\n            }\n            this.userActive = true;\n        });\n\n        this._container.addEventListener('mousemove', () => this.userActive = true);\n\n        this.userActiveCheck = window.setInterval(() => {\n            if (!this.userActive) {\n                return;\n            }\n\n            this.userActive = false;\n\n            this.showControls();\n\n            clearTimeout(this.userInactiveTimeout);\n\n            this.userInactiveTimeout = window.setTimeout(() => {\n                // We don't want to hide the controls when the settings popup is currently open/visible.\n                if (!this.userActive && !this._settingsWrapper.classList.contains('cinematicjs-dropdown-active')) {\n                    this.hideControls();\n\n                    const _activeElement = document.activeElement;\n                    if (_activeElement && _activeElement.parentElement == this._controls) {\n                        // We put focus on the video element so hotkeys work again after a control bar button is pressed\n                        // and the user is inactive again.\n                        this._video.focus();\n                    }\n                }\n            }, 2000);\n\n\n        }, 250);\n\n        this._progressBar.addEventListener('click', function (event) {\n            const target = event.target as HTMLElement;\n            const rect = target.getBoundingClientRect();\n            const pos = (event.clientX - rect.left) / this.offsetWidth;\n            me._video.currentTime = pos * me._video.duration;\n        });\n\n        if (this.fullScreenEnabled) {\n            this._fullScreenButton.addEventListener('click', () => me.toggleFullScreen());\n\n            document.addEventListener('fullscreenchange', () => this.handleFullScreenChange());\n            document.addEventListener('webkitfullscreenchange', () => this.handleFullScreenChange());\n        }\n\n        if (this.options.deeplink) {\n            this._deeplinkButton.addEventListener('click', () => {\n                if (!this.options.deeplinkCallback || this.options.deeplinkCallback.call(this)) {\n                    me.copyToClipboard(me.options.deeplink, me._deeplinkButton);\n                }\n            });\n        }\n\n        this._captionsButton.addEventListener('click', function () {\n            me._cuesContainer.classList.toggle('cinematicjs-hidden');\n            if (me.captionsEnabled) {\n                me._captionsButton.title = me.options.translations.showSubtitles;\n                Cinematic.switchButtonIcon(me._captionsButton, 'expanded-cc');\n            } else {\n                me._captionsButton.title = me.options.translations.hideSubtitles;\n                Cinematic.switchButtonIcon(me._captionsButton, 'cc');\n            }\n            me.captionsEnabled = !me.captionsEnabled;\n        });\n\n        if (this.pipEnabled) {\n            this._pipButton.addEventListener('click', async () => {\n                try {\n                    if (this._video !== document.pictureInPictureElement) {\n                        await this._video.requestPictureInPicture();\n                    } else {\n                        await document.exitPictureInPicture();\n                    }\n                } catch (error) {\n                    console.error(error)\n                }\n            });\n        }\n\n        if (this.options.closeCallback) {\n            this._closeButton.addEventListener('click', () => {\n                this.options.closeCallback?.apply(this);\n            });\n        }\n\n        this._video.addEventListener('keydown', event => {\n            const {key} = event;\n\n            event.preventDefault();\n            event.stopPropagation();\n\n            switch (key) {\n                // Space bar allows to pause/resume the video\n                case ' ':\n                case 'Spacebar':\n                    this.userActive = true;\n                    if (this._video.paused) {\n                        this._video.play();\n                        this.showOverlay('play', null, true);\n                    } else {\n                        this._video.pause();\n                        this.showOverlay('pause', null, true);\n                    }\n                    break;\n                // Escape leaves the fullscreen when currently enabled\n                case 'Escape':\n                    this.userActive = true;\n                    if (this.fullScreenEnabled && this.isFullScreen()) {\n                        this.toggleFullScreen();\n                    }\n                    break;\n                // Left Arrow skips 10 seconds into the past\n                case 'ArrowLeft':\n                case 'Left':\n                    this.userActive = true;\n                    this._video.currentTime -= 10;\n                    this.showOverlay('backwards', '- 10s', true);\n                    break;\n                // Right Arrow skips 10 seconds into the future\n                case 'ArrowRight':\n                case 'Right':\n                    this.userActive = true;\n                    this._video.currentTime += 10;\n                    this.showOverlay('fastforward', '+ 10s', true);\n                    break;\n                // Down Arrow decreases the volume by 5%\n                case 'ArrowDown':\n                case 'Down':\n                    this.userActive = true;\n                    if (this._video.volume > 0) {\n                        let currentVolume = Math.round((this._video.volume + Cinematic.getEpsilon()) * 100);\n                        this.volume = (currentVolume - 5) / 100;\n                        this._video.volume = this.volume;\n                        if (this.volume === 0) {\n                            // Also switch on mute when we reach 0% volume\n                            this._video.muted = true;\n                            this.showOverlay('mute', '0 %', true);\n                        } else {\n                            this.showOverlay('low', Math.round(this.volume * 100) + ' %', true);\n                        }\n                        this._volumeSlider.value = this.volume.toString();\n                    }\n                    break;\n                // Up Arrow increases the volume by 5%\n                case 'ArrowUp':\n                case 'Up':\n                    this.userActive = true;\n                    if (this._video.volume < 1) {\n                        let currentVolume = Math.round((this._video.volume + Cinematic.getEpsilon()) * 100);\n                        this.volume = (currentVolume + 5) / 100;\n                        this._video.volume = this.volume;\n                        // Unmute if we previously were muted\n                        this._video.muted = false;\n                        this.showOverlay('sound', Math.round(this.volume * 100) + ' %', true);\n                        this._volumeSlider.value = this.volume.toString();\n                    }\n                    break;\n            }\n        });\n\n        return true;\n    }\n\n    private handleVideoChange() {\n        this.prepareSubtitles();\n        this.renderQualityOptions();\n        this.handleQualityChange(this.quality);\n        this.handleSpeedChange(this.speed);\n        this.updateDisplayedVideoInfo();\n\n        this._video.currentTime = 0;\n        this._video.play();\n    }\n\n    private updateDisplayedVideoInfo() {\n        const currentVideo = this.playlist.getCurrentVideo();\n        this._video.poster = currentVideo.poster || '';\n        this._videoTitleIcon.src = currentVideo.titleIcon || '';\n        this._videoTitleIcon.classList.toggle('cinematicjs-hidden', this._videoTitleIcon.src.length === 0);\n        this._videoTitle.textContent = currentVideo.title || '';\n        this._videoTitle.classList.toggle('cinematicjs-clickable', !!currentVideo.description);\n        this._videoInfoButton.classList.toggle('cinematicjs-hidden', !currentVideo.description);\n        this._videoDescription.textContent = currentVideo.description || '';\n    }\n\n    private handlePlayerResize() {\n        if (this._container.clientWidth >= 328) {\n            this._timer.classList.remove('cinematicjs-hidden');\n        } else {\n            this._timer.classList.add('cinematicjs-hidden');\n        }\n    }\n\n    private static renderButtonIcon(_button: HTMLDivElement, icon: string) {\n        const _icon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        _icon.setAttribute('viewBox', '0 0 24 24');\n        const _use = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n        _use.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#icon-' + icon);\n        _icon.appendChild(_use);\n        _button.appendChild(_icon);\n    }\n\n    private static switchButtonIcon(_button: HTMLDivElement, newIcon: string) {\n        _button.querySelector('svg use')?.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#icon-' + newIcon);\n    }\n\n    private showOverlay(icon: string, text: string | null, hideAutomatically: boolean) {\n        Cinematic.switchButtonIcon(this._overlayIcon, icon);\n        this._overlayText.textContent = text;\n        this._overlayWrapper.classList.remove('cinematicjs-hidden');\n\n        clearTimeout(this.overlayHideTimeout);\n\n        if (hideAutomatically) {\n            this.overlayHideTimeout = window.setTimeout(() => {\n                this._overlayWrapper.classList.add('cinematicjs-hidden');\n            }, 500);\n        }\n    }\n\n    formatTime(seconds: number) {\n        let hourComponent = Math.floor(seconds / 3600);\n        let minuteComponent = Math.floor(seconds / 60 % 60);\n        let secondComponent = Math.floor(seconds % 60);\n\n        let timer = this.toTimerComponent(minuteComponent) + ':' + this.toTimerComponent(secondComponent);\n\n        if (this.totalSeconds >= (60 * 60)) {\n            // Include the hours in both timers when the video is at least an hour long\n            return this.toTimerComponent(hourComponent) + ':' + timer;\n        }\n\n        return timer;\n    }\n\n    toTimerComponent(value: number) {\n        return value < 10 ? '0' + value : value;\n    }\n\n    updateTimer() {\n        this._timer.textContent = this.formatTime(this.playedSeconds) + ' / ' + this.formatTime(this.totalSeconds);\n    }\n\n    writeToLocalStore(name: string, value: string) {\n        try {\n            if (window.localStorage) {\n                window.localStorage.setItem('cinematic-js-' + name, value);\n            }\n        } catch (e) {\n            console.log('CinematicJS: Cannot write to local store', {name: name, value: value, error: e});\n        }\n    }\n\n    readFromLocalStore(name: string): string | null {\n        try {\n            if (window.localStorage) {\n                return window.localStorage.getItem('cinematic-js-' + name);\n            }\n        } catch (e) {\n            console.log('CinematicJS: Cannot read from local store', {name: name, error: e});\n        }\n        return null;\n    }\n\n    toggleFullScreen() {\n        if (document.fullscreenElement) {\n            document.exitFullscreen();\n        } else if (document.webkitFullscreenElement) {\n            // Need this to support Safari\n            document.webkitExitFullscreen();\n        } else if (this._container.webkitRequestFullscreen) {\n            // Need this to support Safari\n            this._container.webkitRequestFullscreen();\n        } else if (this._video.webkitEnterFullscreen) {\n            // Need this to support iOS Safari\n            this._video.webkitEnterFullscreen();\n        } else {\n            this._container.requestFullscreen();\n        }\n    }\n\n    handleFullScreenChange() {\n        if (this.isFullScreen()) {\n            this._container.dataset.fullscreen = true;\n            Cinematic.switchButtonIcon(this._fullScreenButton, 'closefullscreen');\n            this._fullScreenButton.title = this.options.translations.exitFullscreen;\n        } else {\n            this._container.dataset.fullscreen = false;\n            Cinematic.switchButtonIcon(this._fullScreenButton, 'fullscreen');\n            this._fullScreenButton.title = this.options.translations.fullscreen;\n        }\n    }\n\n    showControls() {\n        this._container.classList.remove('cinematicjs-video-user-inactive');\n        this._uiWrapper.classList.remove('cinematicjs-hidden');\n    }\n\n    hideControls() {\n        if (this._video.paused) {\n            return;\n        }\n\n        this._container.classList.add('cinematicjs-video-user-inactive');\n        this._uiWrapper.classList.add('cinematicjs-hidden');\n    }\n\n    isFullScreen() {\n        return document.fullscreenElement || document.webkitFullscreenElement;\n    }\n\n    copyToClipboard(text: string, _element: HTMLElement) {\n        /*\n         * inspired by clipboard.js v1.5.12\n         * https://zenorocha.github.io/clipboard.js\n         *\n         * Licensed MIT © Zeno Rocha\n         */\n        const fakeElem = document.createElement('textarea');\n        fakeElem.contentEditable = 'true';\n        // Prevent zooming on iOS\n        fakeElem.style.fontSize = '12pt';\n        // Reset box model\n        fakeElem.style.border = '0';\n        fakeElem.style.padding = '0';\n        fakeElem.style.margin = '0';\n        // Move element out of screen horizontally\n        fakeElem.style.position = 'absolute';\n        fakeElem.style[document.documentElement.getAttribute('dir') == 'rtl' ? 'right' : 'left'] = '-9999px';\n        // Move element to the same position vertically\n        fakeElem.style.top = (window.pageYOffset || document.documentElement.scrollTop) + 'px';\n        fakeElem.setAttribute('readonly', '');\n        fakeElem.value = text;\n        document.body.appendChild(fakeElem);\n        fakeElem.focus();\n\n        const range = document.createRange();\n        range.selectNodeContents(fakeElem);\n        const selection = window.getSelection();\n        selection?.removeAllRanges();\n        selection?.addRange(range);\n        fakeElem.setSelectionRange(0, text.length);\n\n        if (document.execCommand('copy') && typeof _element !== 'undefined') {\n            _element.classList.add('cinematicjs-copied');\n            setTimeout(function () {\n                _element.classList.remove('cinematicjs-copied');\n            }, 2000);\n        }\n        document.body.removeChild(fakeElem);\n\n        /* Try alternative */\n        const copy = function (event: ClipboardEvent) {\n            if (event.clipboardData) {\n                event.clipboardData.setData('text/plain', text);\n            } else if ((<any>window).clipboardData) {\n                (<any>window).clipboardData.setData('Text', text);\n            }\n            event.preventDefault();\n        }\n\n        window.addEventListener('copy', copy);\n        document.execCommand('copy');\n        window.removeEventListener('copy', copy);\n    }\n\n    private static getEpsilon(): number {\n        if (Number.EPSILON) {\n            return Number.EPSILON;\n        }\n        let epsilon = 1.0;\n        while ((1.0 + 0.5 * epsilon) !== 1.0) {\n            epsilon *= 0.5;\n        }\n        return epsilon;\n    }\n}\n\nclass CinematicVideo {\n    poster: string;\n    titleIcon: string;\n    title: string;\n    description: string;\n    subtitles: string | null;\n    sources: VideoQuality[];\n\n    constructor(options: VideoOptions) {\n        this.poster = options.poster;\n        this.titleIcon = options.titleIcon;\n        this.title = options.title;\n        this.description = options.description;\n        this.subtitles = options.subtitles;\n        this.sources = options.sources;\n    }\n\n    getSourcesForQuality(quality: string): VideoQuality | null {\n        if (this.sources.length === 1) {\n            return this.sources[0];\n        }\n        for (let source of this.sources) {\n            if (source.quality === quality) {\n                return source;\n            }\n        }\n        return null;\n    }\n\n    getBestAvailableQuality(): string {\n        return this.sources[0].quality;\n    }\n}\n\nclass CinematicPlaylist {\n    loop: boolean;\n    videos: CinematicVideo[];\n    currentVideo: number;\n\n    constructor(loop: boolean, videos: CinematicVideo[]) {\n        this.loop = loop;\n        this.videos = videos;\n        this.currentVideo = 0;\n\n        if (this.videos.length === 0) {\n            throw new Error('CinematicJS: At least one video has to be passed.');\n        }\n    }\n\n    getCurrentVideo(): CinematicVideo {\n        return this.videos[this.currentVideo];\n    }\n\n    shouldPlayNextVideo(): boolean {\n        return this.videos.length > 1 && (this.currentVideo + 1 < this.videos.length || this.loop);\n    }\n\n    startNextVideo() {\n        this.currentVideo++;\n        if (this.loop && this.currentVideo >= this.videos.length) {\n            this.resetToBeginning();\n        }\n    }\n\n    resetToBeginning() {\n        this.currentVideo = 0;\n    }\n}\n"]}
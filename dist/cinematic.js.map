{"version":3,"file":"cinematic.js","sourceRoot":"","sources":["../lib/cinematic.ts"],"names":[],"mappings":"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","sourcesContent":["interface Document {\n    webkitExitFullscreen: any;\n    webkitFullscreenElement: any;\n    webkitFullscreenEnabled: any;\n}\n\ninterface HTMLVideoElement {\n    webkitEnterFullscreen: any;\n    webkitSupportsFullscreen: any;\n}\n\ninterface Options {\n    selector: string;\n    baseUri: string;\n    poster: string;\n    subtitles: string;\n    autoplay: boolean;\n    startTime: number;\n    deeplink: string;\n    rememberVolume: boolean;\n    quality: string;\n    sources: VideoQuality[];\n    closeCallback?: CloseCallback;\n    translations: Translations;\n}\n\ninterface CloseCallback {\n    (): void;\n}\n\ninterface VideoQuality {\n    quality: string;\n    sources: VideoSource[];\n}\n\ninterface VideoSource {\n    type: string;\n    source: string;\n}\n\ninterface Translations {\n    pause: string;\n    play: string;\n    restart: string;\n    mute: string;\n    unmute: string;\n    quality: string;\n    fullscreen: string;\n    deeplink: string;\n    close: string;\n    deeplinkCopied: string;\n    exitFullscreen: string;\n    showSubtitles: string;\n    hideSubtitles: string;\n}\n\nclass Cinematic {\n\n    options: Options;\n\n    defaults: Options = {\n        selector: '',\n        baseUri: '../dist',\n        poster: '',\n        subtitles: '',\n        autoplay: false,\n        startTime: 0,\n        deeplink: '',\n        rememberVolume: false,\n        quality: '720p',\n        sources: [],\n        translations: {\n            pause: 'Pause',\n            play: 'Play',\n            restart: 'Restart',\n            mute: 'Mute',\n            unmute: 'Unmute',\n            quality: 'Quality',\n            fullscreen: 'Fullscreen',\n            close: 'Close',\n            deeplink: 'Copy deeplink to clipboard',\n            deeplinkCopied: 'Link was copied',\n            exitFullscreen: 'Exit Fullscreen',\n            showSubtitles: 'Show Subtitles',\n            hideSubtitles: 'Hide Subtitles',\n        }\n    };\n\n    _container: any;\n    _video: HTMLVideoElement;\n    _sources: HTMLSourceElement[] = [];\n    _cues: HTMLElement;\n    _cuesContainer: HTMLElement;\n    _header: HTMLElement;\n    _footer: HTMLElement;\n    _controls: HTMLElement;\n    _playButton: HTMLDivElement;\n    _bufferBar: HTMLProgressElement;\n    _progressBar: HTMLProgressElement;\n    _timer: HTMLElement;\n    _volumeSlider: HTMLInputElement;\n    _volumeButton: HTMLDivElement;\n    _qualityOptions: NodeListOf<ChildNode>;\n    _captionsButton: HTMLElement;\n    _deeplinkButton: HTMLElement;\n    _fullScreenButton: HTMLDivElement;\n    _closeButton: HTMLElement;\n    _overlayWrapper: HTMLDivElement;\n    _overlayIcon: HTMLDivElement;\n    _overlayText: HTMLDivElement;\n\n    totalSeconds = 0;\n    playedSeconds = 0;\n    volume = 0;\n    quality = '';\n    tracks: TextTrack;\n    cues: TextTrackCueList | null;\n\n    fullScreenEnabled = false;\n    userActive = false;\n    userActiveCheck: number;\n    userInactiveTimeout: number;\n    overlayHideTimeout: number;\n\n    constructor(options: Options) {\n        this.options = {...this.defaults, ...options};\n\n        const _passedContainer = document.querySelector(this.options.selector);\n        if (!_passedContainer) {\n            throw new Error('CinematicJS: Passed selector does not point to a DOM element.');\n        }\n        this._container = _passedContainer;\n\n        this.quality = this.options.quality;\n\n        this.loadIcons();\n        this.renderPlayer();\n        this.setupEvents();\n\n        this._video.load();\n\n        if (this.options.rememberVolume) {\n            const storedVolume = this.readFromLocalStore('volume');\n            if (storedVolume) {\n                this._video.volume = Number.parseFloat(storedVolume);\n            }\n            const storedMuteState = this.readFromLocalStore('muted');\n            if (storedMuteState) {\n                this._video.muted = storedMuteState === 'true';\n            }\n        }\n\n        this._container.cinematic = this as Cinematic;\n    }\n\n    loadIcons() {\n        const _iconContainer = document.createElement('span');\n        _iconContainer.classList.add('token-autocomplete-suggestion-thumbnail');\n        document.body.appendChild(_iconContainer);\n\n        const request = new XMLHttpRequest();\n        request.open(\"GET\", this.options.baseUri + '/icons.svg', true);\n        request.responseType = \"document\";\n        request.onload = () => {\n            const svg = request?.responseXML?.documentElement;\n            // Don't render anything that is not an SVG, e.g. an HTML error page\n            if (svg && svg.nodeName === 'svg') {\n                _iconContainer.appendChild(svg);\n            }\n        }\n        request.send();\n    }\n\n    renderPlayer() {\n        this._container.classList.add('video-container');\n\n        const _video = document.createElement('video');\n        _video.preload = 'metadata';\n        _video.poster = this.options.poster;\n        _video.tabIndex = -1;\n        _video.playsInline = true;\n        // Suppress the unwanted right click context menu of the video element itself\n        _video.oncontextmenu = () => {\n            return false\n        };\n        if (this.options.autoplay) {\n            _video.autoplay = true;\n        }\n        this._container.appendChild(_video);\n\n        this._video = _video;\n\n        this.fullScreenEnabled = document.fullscreenEnabled || document.webkitFullscreenEnabled || _video.webkitSupportsFullscreen;\n\n        if (this.options.sources.length === 0) {\n            throw new Error('CinematicJS: At least one source has to be passed.');\n        }\n\n        let startSource;\n        if (this.options.sources.length === 1) {\n            startSource = this.options.sources[0];\n        } else {\n            startSource = this.getSourcesForQuality(this.quality);\n        }\n        if (!startSource) {\n            throw new Error('CinematicJS: Passed quality does not match any of the passed sources.');\n        }\n\n        startSource.sources.forEach(source => {\n            const _source = document.createElement('source');\n            _source.src = source.source;\n            _source.type = source.type;\n            _video.appendChild(_source);\n            this._sources.push(_source);\n        });\n\n        if (this.options.subtitles) {\n            const _subtitles = document.createElement('track');\n            _subtitles.label = 'subtitles';\n            _subtitles.kind = 'subtitles';\n            _subtitles.src = this.options.subtitles;\n            _subtitles.default = true;\n            _video.appendChild(_subtitles);\n\n            this.tracks = _video.textTracks[0];\n            this.tracks.mode = 'hidden';\n            this.cues = this.tracks.cues;\n\n            const _cuesContainer = document.createElement('div');\n            _cuesContainer.classList.add('video-cues-container');\n            _cuesContainer.classList.add('hidden');\n            this._container.appendChild(_cuesContainer);\n\n            const _cues = document.createElement('div');\n            _cues.classList.add('video-cues');\n            _cues.classList.add('hidden');\n            _cuesContainer.appendChild(_cues);\n\n            this._cues = _cues;\n\n            this._cuesContainer = _cuesContainer;\n        }\n\n        const _overlayWrapper = document.createElement('div');\n        _overlayWrapper.classList.add('video-overlay-wrapper');\n        _overlayWrapper.classList.add('hidden');\n        this._container.appendChild(_overlayWrapper);\n\n        this._overlayWrapper = _overlayWrapper;\n\n        const _overlayContainer = document.createElement('div');\n        _overlayContainer.classList.add('video-overlay-container');\n        _overlayWrapper.appendChild(_overlayContainer);\n\n        const _overlayIcon = document.createElement('div');\n        _overlayIcon.classList.add('video-overlay-icon');\n        _overlayContainer.appendChild(_overlayIcon);\n        Cinematic.renderButtonIcon(_overlayIcon, 'mute');\n        this._overlayIcon = _overlayIcon;\n\n        const _overlayText = document.createElement('div');\n        _overlayText.classList.add('video-overlay-text');\n        _overlayContainer.appendChild(_overlayText);\n        this._overlayText = _overlayText;\n\n        const _header = document.createElement('div');\n        _header.classList.add('video-header');\n        this._container.appendChild(_header);\n\n        this._header = _header;\n\n        if (this.options.closeCallback) {\n            const _closeButton = document.createElement('div');\n            _closeButton.classList.add('video-close-button');\n            _closeButton.title = this.options.translations.close;\n            Cinematic.renderButtonIcon(_closeButton, 'close');\n            _header.appendChild(_closeButton);\n\n            this._closeButton = _closeButton;\n        }\n\n        const _footer = document.createElement('div');\n        _footer.classList.add('video-footer');\n        this._container.appendChild(_footer);\n\n        this._footer = _footer;\n\n        const _progressWrapper = document.createElement('div');\n        _progressWrapper.classList.add('video-progress-wrapper');\n        _footer.appendChild(_progressWrapper);\n\n        const _bufferBar = document.createElement('progress');\n        _bufferBar.classList.add('video-buffer-bar');\n        _bufferBar.value = 0;\n        _progressWrapper.appendChild(_bufferBar);\n\n        this._bufferBar = _bufferBar;\n\n        const _progressBar = document.createElement('progress');\n        _progressBar.classList.add('video-progress-bar');\n        _progressBar.value = 0;\n        _progressWrapper.appendChild(_progressBar);\n\n        this._progressBar = _progressBar;\n\n        const _controls = document.createElement('div');\n        _controls.classList.add('video-controls');\n        _footer.appendChild(_controls);\n\n        this._controls = _controls;\n\n        const _playButton = document.createElement('div');\n        _playButton.classList.add('video-control-button');\n        Cinematic.renderButtonIcon(_playButton, 'play');\n        _controls.appendChild(_playButton);\n\n        this._playButton = _playButton;\n\n        const _timer = document.createElement('span');\n        _timer.classList.add('video-control-timer');\n        _timer.textContent = '00:00:00 / 00:00:00';\n        _controls.appendChild(_timer);\n\n        this._timer = _timer;\n\n        const _spacer = document.createElement('div');\n        _spacer.classList.add('video-control-spacer');\n        _controls.appendChild(_spacer);\n\n        const _volumeWrapper = document.createElement('div');\n        _volumeWrapper.classList.add('video-volume-wrapper');\n        _controls.appendChild(_volumeWrapper);\n\n        const _volumeSlider = document.createElement('input');\n        _volumeSlider.type = 'range';\n        _volumeSlider.min = '0';\n        _volumeSlider.max = '1';\n        _volumeSlider.step = '0.05';\n        _volumeSlider.value = '1';\n        _volumeSlider.classList.add('video-volume-slider');\n        _volumeWrapper.appendChild(_volumeSlider);\n\n        this._volumeSlider = _volumeSlider;\n\n        const _volumeButton = document.createElement('div');\n        _volumeButton.classList.add('video-control-button');\n        _volumeButton.title = this.options.translations.mute;\n        Cinematic.renderButtonIcon(_volumeButton, 'sound');\n        _volumeWrapper.appendChild(_volumeButton);\n\n        this._volumeButton = _volumeButton;\n\n        if (this.options.sources.length > 1) {\n            const _qualityWrapper = document.createElement('div');\n            _qualityWrapper.classList.add('video-control-dropdown');\n            _controls.appendChild(_qualityWrapper);\n\n            const _qualityButton = document.createElement('div');\n            _qualityButton.classList.add('video-control-button');\n            _qualityButton.title = this.options.translations.quality;\n            Cinematic.renderButtonIcon(_qualityButton, 'settings');\n            _qualityWrapper.appendChild(_qualityButton);\n\n            const _dropDownContent = document.createElement('div');\n            _dropDownContent.classList.add('video-dropdown-content');\n            _qualityWrapper.appendChild(_dropDownContent);\n\n            this.options.sources.forEach(source => {\n                const _option = document.createElement('div');\n                _option.classList.add('video-quality-option');\n                if (this.quality === source.quality) {\n                    _option.classList.add('active');\n                }\n                _option.dataset.quality = source.quality;\n                _option.textContent = source.quality;\n                _dropDownContent.appendChild(_option);\n            });\n\n            this._qualityOptions = _dropDownContent.childNodes;\n        }\n\n        if (this.options.deeplink) {\n            const _deeplinkButton = document.createElement('div');\n            _deeplinkButton.classList.add('video-control-button');\n            _deeplinkButton.title = this.options.translations.deeplink;\n            _deeplinkButton.dataset.copiedText = this.options.translations.deeplinkCopied;\n            Cinematic.renderButtonIcon(_deeplinkButton, 'deeplink');\n            _controls.appendChild(_deeplinkButton);\n\n            this._deeplinkButton = _deeplinkButton;\n        }\n\n        if (this.options.subtitles) {\n            const _captionsButton = document.createElement('div');\n            _captionsButton.classList.add('video-control-button');\n            _captionsButton.title = this.options.translations.showSubtitles;\n            Cinematic.renderButtonIcon(_captionsButton, 'expanded-cc');\n            _controls.appendChild(_captionsButton);\n\n            this._captionsButton = _captionsButton;\n        }\n\n        if (this.fullScreenEnabled) {\n            const _fullScreenButton = document.createElement('div');\n            _fullScreenButton.classList.add('video-control-button');\n            _fullScreenButton.title = this.options.translations.fullscreen;\n            Cinematic.renderButtonIcon(_fullScreenButton, 'fullscreen');\n            _controls.appendChild(_fullScreenButton);\n\n            this._fullScreenButton = _fullScreenButton;\n        }\n    }\n\n    setupEvents() {\n        const me = this;\n\n        window.addEventListener('resize', this.handlePlayerResize);\n        this.handlePlayerResize();\n\n        this._playButton.addEventListener('click', () => {\n            if (this._video.paused || this._video.ended) {\n                this._video.play();\n            } else {\n                this._video.pause();\n            }\n        });\n\n        this._volumeButton.addEventListener('click', () => {\n            this._video.muted = !this._video.muted;\n        });\n\n        this._volumeSlider.addEventListener('change', () => {\n            // To allow the user to change from mute to a specific volume via the slider.\n            this._video.muted = false;\n            this._video.volume = this.volume = parseFloat(this._volumeSlider.value);\n        });\n\n        const onCueEnter = function (this: any) {\n            me._cues.textContent = this.text;\n            me._cues.classList.remove('hidden');\n        };\n\n        const onCueExit = function () {\n            me._cues.textContent = '';\n            me._cues.classList.add('hidden');\n        };\n\n        this._video.addEventListener('loadedmetadata', function () {\n            me.totalSeconds = this.duration;\n            me._progressBar.setAttribute('max', me.totalSeconds.toString());\n            me._bufferBar.setAttribute('max', me.totalSeconds.toString());\n            me.updateTimer();\n\n            if (me.options.startTime > 0) {\n                this.currentTime = me.options.startTime;\n            }\n\n            if (me.cues) {\n                for (let i = 0; i < me.cues.length; i++) {\n                    let cue = me.cues[i];\n                    cue.onenter = onCueEnter;\n                    cue.onexit = onCueExit;\n                }\n            }\n        });\n\n        this._video.addEventListener('timeupdate', function () {\n            me.playedSeconds = this.currentTime;\n            me._progressBar.value = me.playedSeconds;\n\n            me.updateTimer();\n        });\n\n        this._video.addEventListener('volumechange', () => {\n            if (this.options.rememberVolume) {\n                this.writeToLocalStore('volume', this._video.volume.toString());\n                this.writeToLocalStore('muted', String(this._video.muted));\n            }\n\n            if (this._video.muted) {\n                // Set the volume slider to its min value to indicate the mute.\n                this._volumeSlider.value = '0';\n                Cinematic.switchButtonIcon(this._volumeButton, 'mute');\n                this._volumeButton.title = this.options.translations.unmute;\n            } else {\n                this._volumeSlider.value = this._video.volume.toString();\n                this._volumeButton.title = this.options.translations.mute;\n                if (this.volume > 0.5) {\n                    Cinematic.switchButtonIcon(this._volumeButton, 'sound');\n                } else {\n                    Cinematic.switchButtonIcon(this._volumeButton, 'low');\n                }\n            }\n        });\n\n        this._video.addEventListener('play', () => {\n            Cinematic.switchButtonIcon(me._playButton, 'pause');\n            me._playButton.title = me.options.translations.pause;\n            me._video.focus();\n            \n            // Shows the timer even when video container is invisible during initialization of the player\n            this.handlePlayerResize();\n        });\n\n        this._video.addEventListener('pause', function () {\n            Cinematic.switchButtonIcon(me._playButton, 'play');\n            me._playButton.title = me.options.translations.play;\n        });\n\n        this._video.addEventListener('ended', function () {\n            Cinematic.switchButtonIcon(me._playButton, 'repeat');\n            me._playButton.title = me.options.translations.restart;\n        });\n\n        this._video.addEventListener('progress', function () {\n            if (this.duration > 0) {\n                for (let i = 0; i < this.buffered.length; i++) {\n                    const bufferRangeIndex = this.buffered.length - 1 - i;\n                    const bufferStart = this.buffered.start(bufferRangeIndex);\n                    const bufferEnd = this.buffered.end(bufferRangeIndex);\n                    if (bufferStart <= this.currentTime) {\n                        me._bufferBar.value = (bufferEnd / this.duration) * 100;\n                        break;\n                    }\n                }\n            }\n        });\n\n        this._video.addEventListener('click', () => {\n            if (me._video.paused || me._video.ended) {\n                me._video.play();\n            } else {\n                me._video.pause();\n            }\n            this.userActive = true;\n        });\n\n        this._container.addEventListener('mousemove', () => this.userActive = true);\n\n        this.userActiveCheck = window.setInterval(() => {\n            if (!this.userActive) {\n                return;\n            }\n\n            this.userActive = false;\n\n            this.showControls();\n\n            clearTimeout(this.userInactiveTimeout);\n\n            this.userInactiveTimeout = window.setTimeout(() => {\n                if (!this.userActive) {\n                    this.hideControls();\n\n                    const _activeElement = document.activeElement;\n                    if (_activeElement && _activeElement.parentElement == this._controls) {\n                        // We put focus on the video element so hotkeys work again after a control bar button is pressed\n                        // and the user is inactive again.\n                        this._video.focus();\n                    }\n                }\n            }, 2000);\n\n\n        }, 250);\n\n        this._progressBar.addEventListener('click', function (event) {\n            const target = event.target as HTMLElement;\n            const rect = target.getBoundingClientRect();\n            const pos = (event.clientX - rect.left) / this.offsetWidth;\n            me._video.currentTime = pos * me._video.duration;\n        });\n\n        if (this.fullScreenEnabled) {\n            this._fullScreenButton.addEventListener('click', () => me.toggleFullScreen());\n\n            document.addEventListener('fullscreenchange', () => this.handleFullScreenChange());\n            document.addEventListener('webkitfullscreenchange', () => this.handleFullScreenChange());\n        }\n\n        if (this.options.sources.length > 1) {\n            this._qualityOptions.forEach(function (_qualityOption: HTMLElement) {\n                _qualityOption.addEventListener('click', function () {\n                    const newQuality = _qualityOption.dataset.quality;\n                    const currentQuality = me.quality;\n\n                    if (!newQuality || newQuality === currentQuality) {\n                        return;\n                    }\n\n                    me._qualityOptions.forEach(function (_qualityOption: HTMLElement) {\n                        _qualityOption.classList.remove('active');\n                    });\n                    _qualityOption.classList.add('active');\n\n                    const currentTime = me._video.currentTime;\n\n                    const newSource = me.options.sources.find(source => newQuality === source.quality);\n                    if (!newSource) {\n                        return;\n                    }\n\n                    newSource.sources.forEach((source, index) => {\n                        const _source = me._sources[index];\n                        if (_source) {\n                            _source.src = source.source;\n                        }\n                    });\n\n                    me._video.load();\n                    me._video.currentTime = currentTime;\n                    me._video.play();\n                    me.quality = newQuality;\n                });\n            });\n        }\n\n        if (this.options.deeplink) {\n            this._deeplinkButton.addEventListener('click', () => {\n                me.copyToClipboard(me.options.deeplink, me._deeplinkButton);\n            });\n        }\n\n        if (this.options.subtitles) {\n            this._captionsButton.addEventListener('click', function () {\n                const wasEnabled = me._container.dataset.captions;\n                me._container.dataset.captions = !wasEnabled;\n                this.classList.toggle('material-icons');\n                this.classList.toggle('material-icons-outlined');\n                me._cuesContainer.classList.toggle('hidden');\n                if (wasEnabled) {\n                    this.title = me.options.translations.showSubtitles;\n                } else {\n                    this.title = me.options.translations.hideSubtitles;\n                }\n            });\n        }\n\n        if (this.options.closeCallback) {\n            this._closeButton.addEventListener('click', () => {\n                this.options.closeCallback?.apply(this);\n            });\n        }\n\n        this._video.addEventListener('keyup', event => {\n            const {key} = event;\n\n            event.preventDefault();\n            event.stopPropagation();\n\n            switch (key) {\n                // Space bar allows to pause/resume the video\n                case ' ':\n                    this.userActive = true;\n                    if (this._video.paused) {\n                        this._video.play();\n                        this.showOverlay('play', null, true);\n                    } else {\n                        this._video.pause();\n                        this.showOverlay('pause', null, true);\n                    }\n                    break;\n                // Escape leaves the fullscreen when currently enabled\n                case 'Escape':\n                    this.userActive = true;\n                    if (this.fullScreenEnabled && this.isFullScreen()) {\n                        this.toggleFullScreen();\n                    }\n                    break;\n                // Left Arrow skips 10 seconds into the past\n                case 'ArrowLeft':\n                    this.userActive = true;\n                    this._video.currentTime -= 10;\n                    break;\n                // Right Arrow skips 10 seconds into the future\n                case 'ArrowRight':\n                    this.userActive = true;\n                    this._video.currentTime += 10;\n                    break;\n                // Down Arrow decreases the volume by 5%\n                case 'ArrowDown':\n                    this.userActive = true;\n                    if (this._video.volume > 0) {\n                        let currentVolume = Math.round((this._video.volume + Number.EPSILON) * 100);\n                        this.volume = (currentVolume - 5) / 100;\n                        this._video.volume = this.volume;\n                        if (this.volume === 0) {\n                            // Also switch on mute when we reach 0% volume\n                            this._video.muted = true;\n                            this.showOverlay('mute', '0 %', true);\n                        } else {\n                            this.showOverlay('low', Math.round(this.volume * 100) + ' %', true);\n                        }\n                        this._volumeSlider.value = this.volume.toString();\n                    }\n                    break;\n                // Up Arrow increases the volume by 5%\n                case 'ArrowUp':\n                    this.userActive = true;\n                    if (this._video.volume < 1) {\n                        let currentVolume = Math.round((this._video.volume + Number.EPSILON) * 100);\n                        this.volume = (currentVolume + 5) / 100;\n                        this._video.volume = this.volume;\n                        // Unmute if we previously were muted\n                        this._video.muted = false;\n                        this.showOverlay('sound', Math.round(this.volume * 100) + ' %', true);\n                        this._volumeSlider.value = this.volume.toString();\n                    }\n                    break;\n            }\n        });\n\n        return true;\n    }\n    \n    private handlePlayerResize() {\n        if (this._container.clientWidth >= 328) {\n            this._timer.classList.remove('hidden');\n        } else {\n            this._timer.classList.add('hidden');\n        }\n    }\n\n    private static renderButtonIcon(_button: HTMLDivElement, icon: string) {\n        const _icon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        _icon.setAttribute('viewBox', '0 0 24 24');\n        const _use = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n        _use.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#icon-' + icon);\n        _icon.appendChild(_use);\n        _button.appendChild(_icon);\n    }\n\n    private static switchButtonIcon(_button: HTMLDivElement, newIcon: string) {\n        _button.querySelector('svg use')?.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#icon-' + newIcon);\n    }\n\n    private showOverlay(icon: string, text: string | null, hideAutomatically: boolean) {\n        Cinematic.switchButtonIcon(this._overlayIcon, icon);\n        this._overlayText.textContent = text;\n        this._overlayWrapper.classList.remove('hidden');\n\n        clearTimeout(this.overlayHideTimeout);\n\n        if (hideAutomatically) {\n            this.overlayHideTimeout = window.setTimeout(() => {\n                this._overlayWrapper.classList.add('hidden');\n            }, 500);\n        }\n    }\n\n    getSourcesForQuality(quality: string): VideoQuality | null {\n        for (let source of this.options.sources) {\n            if (source.quality === quality) {\n                return source;\n            }\n        }\n        return null;\n    }\n\n    formatTime(seconds: number) {\n        let hourComponent = Math.floor(seconds / 3600);\n        let minuteComponent = Math.floor((seconds - (hourComponent * 3600)) / 60);\n        let secondComponent = Math.floor(seconds - (hourComponent * 3600) - (minuteComponent * 60));\n\n        let timer = this.toTimerComponent(minuteComponent) + ':' + this.toTimerComponent(secondComponent);\n\n        if (this.totalSeconds >= (60 * 60)) {\n            // Include the hours in both timers when the video is at least an hour long\n            return this.toTimerComponent(hourComponent) + ':' + timer;\n        }\n\n        return timer;\n    }\n\n    toTimerComponent(value: number) {\n        return value < 10 ? \"0\" + value : value;\n    }\n\n    updateTimer() {\n        this._timer.textContent = this.formatTime(this.playedSeconds) + ' / ' + this.formatTime(this.totalSeconds);\n    }\n\n    writeToLocalStore(name: string, value: string) {\n        try {\n            if (window.localStorage) {\n                window.localStorage.setItem('cinematic-js-' + name, value);\n            }\n        } catch (e) {\n            console.log('CinematicJS: Cannot write to local store', {name: name, value: value, error: e});\n        }\n    }\n\n    readFromLocalStore(name: string): string | null {\n        try {\n            if (window.localStorage) {\n                return window.localStorage.getItem('cinematic-js-' + name);\n            }\n        } catch (e) {\n            console.log('CinematicJS: Cannot read from local store', {name: name, error: e});\n        }\n        return null;\n    }\n\n    toggleFullScreen() {\n        if (document.fullscreenElement) {\n            document.exitFullscreen();\n        } else if (document.webkitFullscreenElement) {\n            // Need this to support Safari\n            document.webkitExitFullscreen();\n        } else if (this._container.webkitRequestFullscreen) {\n            // Need this to support Safari\n            this._container.webkitRequestFullscreen();\n        } else if (this._video.webkitEnterFullscreen) {\n            // Need this to support iOS Safari\n            this._video.webkitEnterFullscreen();\n        } else {\n            this._container.requestFullscreen();\n        }\n    }\n\n    handleFullScreenChange() {\n        if (this.isFullScreen()) {\n            this._container.dataset.fullscreen = true;\n            Cinematic.switchButtonIcon(this._fullScreenButton, 'closefullscreen');\n            this._fullScreenButton.title = this.options.translations.exitFullscreen;\n        } else {\n            this._container.dataset.fullscreen = false;\n            Cinematic.switchButtonIcon(this._fullScreenButton, 'fullscreen');\n            this._fullScreenButton.title = this.options.translations.fullscreen;\n        }\n    }\n\n    showControls() {\n        this._container.classList.remove('video-user-inactive');\n        this._header.classList.remove('hidden');\n        this._footer.classList.remove('hidden');\n    }\n\n    hideControls() {\n        if (this._video.paused) {\n            return;\n        }\n\n        this._container.classList.add('video-user-inactive');\n        this._header.classList.add('hidden');\n        this._footer.classList.add('hidden');\n    }\n\n    isFullScreen() {\n        return document.fullscreenElement || document.webkitFullscreenElement;\n    }\n\n    copyToClipboard(text: string, _element: HTMLElement) {\n        /*\n         * inspired by clipboard.js v1.5.12\n         * https://zenorocha.github.io/clipboard.js\n         *\n         * Licensed MIT  Zeno Rocha\n         */\n        const fakeElem = document.createElement('textarea');\n        fakeElem.contentEditable = 'true';\n        // Prevent zooming on iOS\n        fakeElem.style.fontSize = '12pt';\n        // Reset box model\n        fakeElem.style.border = '0';\n        fakeElem.style.padding = '0';\n        fakeElem.style.margin = '0';\n        // Move element out of screen horizontally\n        fakeElem.style.position = 'absolute';\n        fakeElem.style[document.documentElement.getAttribute('dir') == 'rtl' ? 'right' : 'left'] = '-9999px';\n        // Move element to the same position vertically\n        fakeElem.style.top = (window.pageYOffset || document.documentElement.scrollTop) + 'px';\n        fakeElem.setAttribute('readonly', '');\n        fakeElem.value = text;\n        document.body.appendChild(fakeElem);\n        fakeElem.focus();\n\n        const range = document.createRange();\n        range.selectNodeContents(fakeElem);\n        const selection = window.getSelection();\n        selection?.removeAllRanges();\n        selection?.addRange(range);\n        fakeElem.setSelectionRange(0, text.length);\n\n        if (document.execCommand('copy') && typeof _element !== 'undefined') {\n            _element.classList.add('copied');\n            setTimeout(function () {\n                _element.classList.remove('copied');\n            }, 2000);\n        }\n        document.body.removeChild(fakeElem);\n\n        /* Try alternative */\n        const copy = function (event: ClipboardEvent) {\n            if (event.clipboardData) {\n                event.clipboardData.setData('text/plain', text);\n            } else if ((<any>window).clipboardData) {\n                (<any>window).clipboardData.setData('Text', text);\n            }\n            event.preventDefault();\n        }\n\n        window.addEventListener('copy', copy);\n        document.execCommand('copy');\n        window.removeEventListener('copy', copy);\n    }\n}\n"]}